import{D as U,bm as G,a2 as M,O,G as Q,Q as H,R as J,bq as K,a6 as W,a4 as X,T as Y,c as Z,a$ as ee,H as ae,d as a,m as te,_ as le,au as se,i as oe,u as ne,r as k,l as re,ad as ie,a as ue,b as B,w as l,bD as ce,F as L,o as m,n as V,s as de,j as f,t as y,bj as pe,g as v,f as $,I,V as A,aN as me,C as ve,bJ as fe,p as ge,h as _e}from"./index-CBdcX3JV.js";import{_ as he}from"./CartIcon-BVyJFYrB.js";import{b as j}from"./route-block-B_A1xBdJ.js";import{V as be}from"./VContainer-Cl28Eq5v.js";import{V as ke,a as d}from"./VRow-DmnzWbb6.js";import{a as D,V as R}from"./VChip-CR548pP2.js";const ye={actions:"button@2",article:"heading, paragraph",avatar:"avatar",button:"button",card:"image, heading","card-avatar":"image, list-item-avatar",chip:"chip","date-picker":"list-item, heading, divider, date-picker-options, date-picker-days, actions","date-picker-options":"text, avatar@2","date-picker-days":"avatar@28",divider:"divider",heading:"heading",image:"image","list-item":"text","list-item-avatar":"avatar, text","list-item-two-line":"sentences","list-item-avatar-two-line":"avatar, sentences","list-item-three-line":"paragraph","list-item-avatar-three-line":"avatar, paragraph",ossein:"ossein",paragraph:"text@3",sentences:"text@2",subtitle:"text",table:"table-heading, table-thead, table-tbody, table-tfoot","table-heading":"chip, text","table-thead":"heading@6","table-tbody":"table-row-divider@6","table-row-divider":"table-row, divider","table-row":"text@6","table-tfoot":"text@2, avatar@2",text:"text"};function xe(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return a("div",{class:["v-skeleton-loader__bone",`v-skeleton-loader__${e}`]},[r])}function N(e){const[r,o]=e.split("@");return Array.from({length:o}).map(()=>C(r))}function C(e){let r=[];if(!e)return r;const o=ye[e];if(e!==o){if(e.includes(","))return q(e);if(e.includes("@"))return N(e);o.includes(",")?r=q(o):o.includes("@")?r=N(o):o&&r.push(C(o))}return[xe(e,r)]}function q(e){return e.replace(/\s/g,"").split(",").map(C)}const Ve=U({boilerplate:Boolean,color:String,loading:Boolean,loadingText:{type:String,default:"$vuetify.loading"},type:{type:[String,Array],default:"ossein"},...G(),...M(),...O()},"VSkeletonLoader"),Ce=Q()({name:"VSkeletonLoader",props:Ve(),setup(e,r){let{slots:o}=r;const{backgroundColorClasses:w,backgroundColorStyles:p}=H(J(e,"color")),{dimensionStyles:g}=K(e),{elevationClasses:s}=W(e),{themeClasses:_}=X(e),{t:h}=Y(),b=Z(()=>C(ee(e.type).join(",")));return ae(()=>{var x;const c=!o.default||e.loading,P=e.boilerplate||!c?{}:{ariaLive:"polite",ariaLabel:h(e.loadingText),role:"alert"};return a("div",te({class:["v-skeleton-loader",{"v-skeleton-loader--boilerplate":e.boilerplate},_.value,w.value,s.value],style:[p.value,c?g.value:{}]},P),[c?b.value:(x=o.default)==null?void 0:x.call(o)])}),{}}}),S=e=>(ge("data-v-dfc8f67d"),e=e(),_e(),e),Se=S(()=>f("h3",null,"尺寸",-1)),we=S(()=>f("h3",null,"顏色",-1)),Pe=S(()=>f("h3",null,"數量",-1)),ze={class:"px-5"},Be={class:"d-flex align-center pe-1"},Le=S(()=>f("h1",{class:"no-sell-title"}," 此商品已下架 ",-1)),E={__name:"[id]",emits:["update:category"],setup(e,{emit:r}){const{apiAuth:o}=ve(),w=se(),p=oe(),g=ne(),s=k({_id:"",name:"",price:0,images:[],sell:!0,description:"",category:"",colors:[],sizes:[]}),_=k(""),h=k(""),b=k(1),c=k(!0),P=async()=>{var u,n;try{const{data:i}=await o.get(`/product/${w.params.id}`);s.value=i.result,typeof s.value.colors=="string"&&(s.value.colors=s.value.colors.split(",")),typeof s.value.sizes=="string"&&(s.value.sizes=s.value.sizes.split(",")),document.title=`${s.value.name} | VPT`,x("update:category",s.value.category),c.value=!1}catch(i){console.log(i),p({text:((n=(u=i==null?void 0:i.response)==null?void 0:u.data)==null?void 0:n.message)||"發生錯誤",snackbarProps:{color:"red-lighten-1"}}),c.value=!1}};re(()=>{P()});const x=r,T=u=>{b.value=Math.max(1,b.value+u)},F=async()=>{var n,i;if(!g.isLogin){p({text:"請先登入",snackbarProps:{color:"red-lighten-1"}}),fe.push("/loginregister");return}if(!_.value||!h.value){p({text:"請選擇尺寸和顏色",snackbarProps:{color:"red-lighten-1"}});return}const u={p_id:s.value._id,colors:h.value,sizes:_.value,quantity:b.value};try{const{data:t}=await o.patch("/user/cart",u);p({text:"商品已加入購物車",snackbarProps:{color:"teal-darken-1"}}),t.result&&Array.isArray(t.result.cart)?g.cart=[...t.result.cart]:console.error("購物車數據結構錯誤",t.result.cart)}catch(t){console.log(t),p({text:((i=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:i.message)||"發生錯誤",snackbarProps:{color:"red-lighten-1"}})}};return ie(()=>g.cart,u=>{g.cart=u}),(u,n)=>{const i=ue("router-link");return m(),B(L,null,[a(be,null,{default:l(()=>[a(ke,null,{default:l(()=>[a(d,{class:"pa-0 pt-5 pb-4",cols:"12",sm:"6"},{default:l(()=>[c.value?(m(),V(Ce,{key:0,class:"rounded-xl elevation-6 skeleton-full-height",type:"image"})):(m(),V(de,{key:1,src:s.value.images[0],class:"rounded-xl elevation-6 product-img",cover:"",onLoad:n[0]||(n[0]=t=>c.value=!1)},null,8,["src"]))]),_:1}),a(d,{cols:"12",sm:"6",class:"ps-0 ps-sm-10"},{default:l(()=>[a(d,null,{default:l(()=>[f("h2",null,y(s.value.name),1),a(pe,{class:"custom-subtitle mt-2"},{default:l(()=>[v(y(s.value.description),1)]),_:1})]),_:1}),a(d,null,{default:l(()=>[Se,a(D,{modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=t=>_.value=t),class:"pa-0",column:"",filter:""},{default:l(()=>[(m(!0),B(L,null,$(s.value.sizes,(t,z)=>(m(),V(R,{key:z,value:t,size:"large",color:"teal-lighten-1"},{default:l(()=>[v(y(t),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,null,{default:l(()=>[we,a(D,{modelValue:h.value,"onUpdate:modelValue":n[2]||(n[2]=t=>h.value=t),class:"pa-0",column:"",filter:""},{default:l(()=>[(m(!0),B(L,null,$(s.value.colors,(t,z)=>(m(),V(R,{key:z,value:t,size:"large",color:"teal-lighten-1"},{default:l(()=>[v(y(t),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{class:"mb-0 mb-sm-16"},{default:l(()=>[Pe,a(I,{size:"x-small",icon:"",variant:"text",color:"red",onClick:n[3]||(n[3]=t=>T(-1))},{default:l(()=>[a(A,null,{default:l(()=>[v("mdi-minus")]),_:1})]),_:1}),f("span",ze,y(b.value),1),a(I,{size:"x-small",icon:"",variant:"text",color:"#039199",onClick:n[4]||(n[4]=t=>T(1))},{default:l(()=>[a(A,null,{default:l(()=>[v("mdi-plus")]),_:1})]),_:1})]),_:1}),a(d,{class:"py-0"},{default:l(()=>[a(me,{class:"pa-0",justify:"center"},{default:l(()=>[a(I,{class:"addCart-btn",block:"",variant:"outlined",onClick:F},{default:l(()=>[f("div",Be,[a(he,{size:20})]),v(" 加入購物車 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(d,{cols:"12"})]),_:1}),a(ce,{class:"align-center justify-center","model-value":!s.value.sell,persistent:""},{default:l(()=>[Le,a(i,{class:"no-sell-subtitle",to:"/products"},{default:l(()=>[v(" 逛逛其他商品 → ")]),_:1})]),_:1},8,["model-value"])],64)}}};typeof j=="function"&&j(E);const Re=le(E,[["__scopeId","data-v-dfc8f67d"]]);export{Re as default};

import{_ as Q,i as W,l as X,r as C,n as Y,o as i,b as g,d as t,w as e,F as x,q as f,g as c,bk as Z,z as w,e as F,f as v,D as ee,ax as B,h as o,t as n,v as D,J as N,aN as T,p as te,k as le}from"./index-Dl6LQXFh.js";import{C as ae}from"./ConfirmDeleteDialog-ILQbFYBi.js";import{b as j}from"./route-block-B_A1xBdJ.js";import{V as r,a as l}from"./VRow-CYq4dY3q.js";import{V as L}from"./VDivider-Cs6Zqrd2.js";import{V as O,a as M,b as U,c as J}from"./VExpansionPanels-DY6s7CiB.js";import{V as R,a as h}from"./VList-CH2TLUSt.js";const _=y=>(te("data-v-3b852875"),y=y(),le(),y),se=_(()=>o("h3",{class:"opacity-90 mb-4"}," 訂單管理 ",-1)),ce=_(()=>o("div",{class:"text-subtitle-2 font-weight-bold mb-4"}," 訂單編號 ",-1)),ne=_(()=>o("div",{class:"text-subtitle-2 font-weight-bold mb-4"}," 訂單日期 ",-1)),oe=_(()=>o("div",{class:"text-subtitle-2 font-weight-bold mb-4"}," 訂單總額 ",-1)),de=_(()=>o("div",{class:"text-subtitle-2 font-weight-bold mb-4"}," 訂單備註 ",-1)),ue=_(()=>o("div",{class:"order-data-title mb-1"}," 訂單編號 : ",-1)),ie={class:"order-data-text"},re=_(()=>o("div",{class:"order-data-title mb-1"}," 訂單日期 : ",-1)),fe={class:"order-data-text"},_e={class:"total-price-tag ps-1"},G={__name:"order",setup(y){const{apiAuth:z}=ee(),k=W(),{mdAndUp:E}=X(),p=C([]),b=C({open:!1}),V=C(null),H=async()=>{var d,u;try{const{data:a}=await z.get("/order");p.value=a.result.sort((m,s)=>new Date(s.createdAt)-new Date(m.createdAt))}catch(a){console.log(a),k({text:((u=(d=a==null?void 0:a.response)==null?void 0:d.data)==null?void 0:u.message)||"無法加載訂單",snackbarProps:{color:"red-lighten-1"}})}},$=d=>{const u={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(d).toLocaleDateString(void 0,u)},S=d=>d.reduce((u,a)=>u+a.p_id.price*a.quantity,0),A=d=>{V.value=d,b.value.open=!0},I=()=>{b.value.open=!1},K=async()=>{var d,u;try{await z.delete(`/order/${V.value}`),p.value=p.value.filter(a=>a._id!==V.value),k({text:"訂單已取消",snackbarProps:{color:"teal-darken-1"}})}catch(a){console.log(a),k({text:((u=(d=a==null?void 0:a.response)==null?void 0:d.data)==null?void 0:u.message)||"無法取消訂單",snackbarProps:{color:"red-lighten-1"}})}finally{I()}};return Y(()=>{H()}),(d,u)=>(i(),g(x,null,[t(r,{class:"mt-4"},{default:e(()=>[t(l,{cols:"12",class:"pt-0"},{default:e(()=>[t(r,null,{default:e(()=>[t(l,{cols:"12",sm:"3"},{default:e(()=>[se]),_:1})]),_:1})]),_:1}),t(l,{class:"pt-0 pb-2"},{default:e(()=>[t(L)]),_:1}),t(l,{cols:"12"},{default:e(()=>[p.value.length===0?(i(),f(Z,{key:0,align:"center",class:"opacity-80"},{default:e(()=>[c(" 目前您沒有任何訂單 ")]),_:1})):w("",!0),F(E)?(i(),f(O,{key:1},{default:e(()=>[(i(!0),g(x,null,v(p.value,(a,m)=>(i(),f(M,{key:a._id,class:"mb-4"},{default:e(()=>[t(U,{style:B({backgroundColor:m%2===0?"#ECEFF190":"#f0f0f080"})},{default:e(()=>[t(r,{class:"text-center py-4",style:{"font-size":"15px"}},{default:e(()=>[t(l,{cols:"4"},{default:e(()=>[ce,o("div",null,n(a._id),1)]),_:2},1024),t(l,null,{default:e(()=>[ne,o("div",null,n($(a.createdAt)),1)]),_:2},1024),t(l,null,{default:e(()=>[oe,o("div",null,"$"+n(S(a.cart)),1)]),_:2},1024),t(l,null,{default:e(()=>[de,o("div",null,n(a.note||"無"),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["style"]),t(J,null,{default:e(()=>[t(R,null,{default:e(()=>[t(h,{class:"mb-3 opacity-90",style:{"font-size":"12px"}},{default:e(()=>[t(r,{style:{"font-size":"14px","font-weight":"500"},class:"text-center"},{default:e(()=>[t(l,{cols:"2"},{default:e(()=>[c(" 商品縮圖 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品名稱 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品規格 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品價格 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品數量 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品小計 ")]),_:1})]),_:1})]),_:1}),(i(!0),g(x,null,v(a.cart,s=>(i(),f(h,{key:s.p_id._id},{default:e(()=>[t(r,{style:{"font-size":"14px"},class:"text-center"},{default:e(()=>[t(l,{cols:"2"},{default:e(()=>[t(D,{src:s.p_id.images[0],height:"50"},null,8,["src"])]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(n(s.p_id.name),1)]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(n(s.colors)+" / "+n(s.sizes),1)]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(" $"+n(s.p_id.price),1)]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(n(s.quantity),1)]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(" $"+n(s.p_id.price*s.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),t(l,{class:"d-flex justify-end pe-6"},{default:e(()=>[t(N,{color:"red-darken-3",variant:"outlined",onClick:T(s=>A(a._id),["stop"])},{default:e(()=>[c(" 取消訂單 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):w("",!0),F(E)?w("",!0):(i(),f(O,{key:2},{default:e(()=>[(i(!0),g(x,null,v(p.value,(a,m)=>(i(),f(M,{key:a._id,class:"mb-4"},{default:e(()=>[t(U,{style:B({backgroundColor:m%2===0?"#ECEFF190":"#f0f0f080"})},{default:e(()=>[t(r,null,{default:e(()=>[t(l,{cols:"4",sm:"3"},{default:e(()=>{var s,P,q;return[t(D,{src:(q=(P=(s=a==null?void 0:a.cart[0])==null?void 0:s.p_id)==null?void 0:P.images)==null?void 0:q[0],cover:"",class:"data-img"},null,8,["src"])]}),_:2},1024),t(l,{cols:"8",sm:"9"},{default:e(()=>[t(r,null,{default:e(()=>[t(l,{cols:"12",sm:"7"},{default:e(()=>[ue,o("div",ie,n(a._id),1)]),_:2},1024),t(l,{class:"pt-0 pt-sm-3",sm:"5"},{default:e(()=>[re,o("div",fe,n($(a.createdAt)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["style"]),t(J,null,{default:e(()=>[t(R,null,{default:e(()=>[(i(!0),g(x,null,v(a.cart,s=>(i(),f(h,{key:s.p_id._id},{default:e(()=>[t(r,null,{default:e(()=>[t(l,{cols:"3",class:"ps-sm-4"},{default:e(()=>[t(D,{src:s.p_id.images[0],height:"50",width:"50"},null,8,["src"])]),_:2},1024),t(l,{class:"d-flex"},{default:e(()=>[t(r,{"no-gutters":""},{default:e(()=>[t(l,{cols:"12",class:"align-self-center product-text"},{default:e(()=>[c(n(s.p_id.name),1)]),_:2},1024),t(l,{cols:"12",class:"align-self-center product-text"},{default:e(()=>[c(n(s.colors)+" / "+n(s.sizes),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(l,{class:"d-flex"},{default:e(()=>[t(r,{"no-gutters":""},{default:e(()=>[t(l,{cols:"12",class:"align-self-center product-text"},{default:e(()=>[c(" $"+n(s.p_id.price),1)]),_:2},1024),t(l,{cols:"12",class:"align-self-center product-text"},{default:e(()=>[c(" 數量: "+n(s.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(l,{cols:"3",class:"d-flex per-total"},{default:e(()=>[t(r,{"no-gutters":""},{default:e(()=>[t(l,{cols:"12",class:"align-self-center"},{default:e(()=>[c(" 商品小計: ")]),_:1}),t(l,{cols:"12",class:"align-self-center"},{default:e(()=>[c(" $"+n(s.p_id.price*s.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(l,{cols:"12",class:"pt-0 mb-2"},{default:e(()=>[t(L)]),_:1})]),_:2},1024)]),_:2},1024))),128)),t(h,null,{default:e(()=>[t(r,{class:"justify-end"},{default:e(()=>[t(l,{cols:"12",class:"total-price d-flex align-self-center justify-end pe-sm-16"},{default:e(()=>[c(" 訂單總額: "),o("span",_e,"$"+n(S(a.cart)),1)]),_:2},1024),t(l,{cols:"12",class:"d-flex align-self-center justify-end pe-sm-16"},{default:e(()=>[t(N,{class:"cancel-btn",color:"red-darken-3",variant:"outlined",size:"x-small",onClick:T(s=>A(a._id),["stop"])},{default:e(()=>[c(" 取消訂單 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1}),t(ae,{modelValue:b.value.open,"onUpdate:modelValue":u[0]||(u[0]=a=>b.value.open=a),title:"確認要取消此訂單嗎？",message:"取消後不可恢復。","confirm-text":"確認","cancel-text":"取消","confirm-color":"red-darken-3","cancel-color":"blue-grey-darken-1","cancel-size":"small","confirm-size":"small",onConfirm:K,onCancel:I},null,8,["modelValue"])],64))}};typeof j=="function"&&j(G);const he=Q(G,[["__scopeId","data-v-3b852875"]]);export{he as default};

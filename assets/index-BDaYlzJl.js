import{i as S,r as u,ad as T,l as j,o,n as d,w as a,d as l,aK as B,e as F,v as I,b as g,F as _,f as M,z as h,j as k,C as N,m as A}from"./index-CsH3-5tR.js";import{P as L}from"./ProductCard-C5pH7Wh7.js";import{b as V}from"./route-block-B_A1xBdJ.js";import{V as R}from"./VContainer-CDwzZakE.js";import{a as s,V as y}from"./VRow-E_1d4W6t.js";import{V as U}from"./VPagination-r6jKlQhL.js";import"./VHover-CgG1QnYs.js";const z=k("h2",null,"所有商品",-1),G=k("p",null,"沒有找到相關商品",-1),x=18,K={__name:"index",setup(Q){const{api:P}=N(),w=S(),r=u(1),m=u(1),c=u(""),f=u([]),p=u(!1),v=u(!1),i=async()=>{p.value=!0;try{const e={itemsPerPage:x,page:r.value,search:c.value},{data:t}=await P.get("/product",{params:e});if(t.success)f.value=t.result.data,m.value=Math.ceil(t.result.total/x);else throw new Error(t.message||"載入商品失敗")}catch(e){console.error("載入商品時發生錯誤:",e),w({text:e.message||"載入商品時發生錯誤",snackbarProps:{color:"red-lighten-1"}}),f.value=[],m.value=1}finally{p.value=!1}},b=(()=>{let e;return()=>{v.value=!0,clearTimeout(e),e=setTimeout(()=>{r.value=1,i(),v.value=!1},300)}})(),C=()=>{c.value="",r.value=1,i()},E=()=>{window.scrollTo({top:0,behavior:"smooth"}),i()};return T(c,e=>{e===""&&(r.value=1,i())}),j(()=>{i()}),(e,t)=>(o(),d(R,{class:"pa-0"},{default:a(()=>[l(y,{class:"d-flex justify-start align-start"},{default:a(()=>[l(s,{cols:"12",class:"d-flex justify-space-between pb-0"},{default:a(()=>[l(y,null,{default:a(()=>[l(s,null,{default:a(()=>[z]),_:1}),l(s,{sm:"4",md:"3"},{default:a(()=>[l(B,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=n=>c.value=n),variant:"outlined",density:"compact","max-width":"240","append-inner-icon":"mdi-magnify",placeholder:"搜尋商品",loading:v.value,clearable:"",onInput:F(b),"onClick:clear":C},null,8,["modelValue","loading","onInput"])]),_:1})]),_:1})]),_:1}),p.value?(o(),d(s,{key:0,cols:"12",class:"text-center"},{default:a(()=>[l(I,{indeterminate:"",color:"primary"})]),_:1})):(o(),g(_,{key:1},[(o(!0),g(_,null,M(f.value,n=>(o(),d(s,{key:n._id,cols:"6",md:"4",class:"px-0 d-flex justify-center"},{default:a(()=>[l(L,A({ref_for:!0},n),null,16)]),_:2},1024))),128)),f.value.length===0?(o(),d(s,{key:0,cols:"12",class:"text-center"},{default:a(()=>[G]),_:1})):h("",!0)],64)),m.value>1?(o(),d(s,{key:2,cols:"12"},{default:a(()=>[l(U,{modelValue:r.value,"onUpdate:modelValue":[t[1]||(t[1]=n=>r.value=n),E],length:m.value,rounded:"circle",density:"compact","next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",color:"teal-darken-1"},null,8,["modelValue","length"])]),_:1})):h("",!0)]),_:1})]),_:1}))}};typeof V=="function"&&V(K);export{K as default};

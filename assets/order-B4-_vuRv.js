import{_ as Q,i as W,k as X,r as C,l as Y,b as g,d as t,w as e,F as y,o as i,n as f,g as c,bj as Z,z as w,e as F,f as b,C as ee,aw as q,j as n,t as o,s as D,I as B,aM as T,p as te,h as le}from"./index-w7367gOE.js";import{C as ae}from"./ConfirmDeleteDialog-Cnm8fl9p.js";import{b as L}from"./route-block-B_A1xBdJ.js";import{V as r,a as l}from"./VRow-Cs7Ysasj.js";import{V as N}from"./VDivider-D7i7-XbZ.js";import{V as M,a as O,b as U,c as R}from"./VExpansionPanels-C_mf2TNk.js";import{V as G,a as v}from"./VList-noBTfDaj.js";const _=x=>(te("data-v-d97f5a0f"),x=x(),le(),x),se=_(()=>n("h3",{class:"opacity-90 mb-4"}," 訂單管理 ",-1)),ce=_(()=>n("div",{class:"text-subtitle-2 font-weight-bold mb-4"}," 訂單編號 ",-1)),oe=_(()=>n("div",{class:"text-subtitle-2 font-weight-bold mb-4"}," 訂單日期 ",-1)),ne=_(()=>n("div",{class:"text-subtitle-2 font-weight-bold mb-4"}," 訂單總額 ",-1)),de=_(()=>n("div",{class:"text-subtitle-2 font-weight-bold mb-4"}," 訂單備註 ",-1)),ue=_(()=>n("div",{class:"order-data-title mb-1"}," 訂單編號 : ",-1)),ie={class:"order-data-text"},re=_(()=>n("div",{class:"order-data-title mb-1"}," 訂單日期 : ",-1)),fe={class:"order-data-text"},_e={class:"total-price-tag ps-1"},H={__name:"order",setup(x){const{apiAuth:z}=ee(),k=W(),{mdAndUp:E}=X(),p=C([]),h=C({open:!1}),V=C(null),J=async()=>{var d,u;try{const{data:a}=await z.get("/order");p.value=a.result.sort((m,s)=>new Date(s.createdAt)-new Date(m.createdAt)),console.log(a.result)}catch(a){console.log(a),k({text:((u=(d=a==null?void 0:a.response)==null?void 0:d.data)==null?void 0:u.message)||"無法加載訂單",snackbarProps:{color:"red-lighten-1"}})}},$=d=>{const u={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(d).toLocaleDateString(void 0,u)},I=d=>d.reduce((u,a)=>u+a.p_id.price*a.quantity,0),S=d=>{V.value=d,h.value.open=!0},A=()=>{h.value.open=!1},K=async()=>{var d,u;try{await z.delete(`/order/${V.value}`),p.value=p.value.filter(a=>a._id!==V.value),k({text:"訂單已取消",snackbarProps:{color:"teal-darken-1"}})}catch(a){console.log(a),k({text:((u=(d=a==null?void 0:a.response)==null?void 0:d.data)==null?void 0:u.message)||"無法取消訂單",snackbarProps:{color:"red-lighten-1"}})}finally{A()}};return Y(()=>{J()}),(d,u)=>(i(),g(y,null,[t(r,{class:"mt-4"},{default:e(()=>[t(l,{cols:"12",class:"pt-0"},{default:e(()=>[t(r,null,{default:e(()=>[t(l,{cols:"12",sm:"3"},{default:e(()=>[se]),_:1})]),_:1})]),_:1}),t(l,{class:"pt-0 pb-2"},{default:e(()=>[t(N)]),_:1}),t(l,{cols:"12"},{default:e(()=>[p.value.length===0?(i(),f(Z,{key:0,height:"100%",align:"center",class:"opacity-80"},{default:e(()=>[c(" 目前您沒有任何訂單 ")]),_:1})):w("",!0),F(E)?(i(),f(M,{key:1},{default:e(()=>[(i(!0),g(y,null,b(p.value,(a,m)=>(i(),f(O,{key:a._id,class:"mb-4"},{default:e(()=>[t(U,{style:q({backgroundColor:m%2===0?"#ECEFF190":"#f0f0f080"})},{default:e(()=>[t(r,{class:"text-center py-4",style:{"font-size":"15px"}},{default:e(()=>[t(l,{cols:"4"},{default:e(()=>[ce,n("div",null,o(a._id),1)]),_:2},1024),t(l,null,{default:e(()=>[oe,n("div",null,o($(a.createdAt)),1)]),_:2},1024),t(l,null,{default:e(()=>[ne,n("div",null,"$"+o(I(a.cart)),1)]),_:2},1024),t(l,null,{default:e(()=>[de,n("div",null,o(a.note||"無"),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["style"]),t(R,null,{default:e(()=>[t(G,null,{default:e(()=>[t(v,{class:"mb-3 opacity-90",style:{"font-size":"12px"}},{default:e(()=>[t(r,{style:{"font-size":"14px","font-weight":"500"},class:"text-center"},{default:e(()=>[t(l,{cols:"2"},{default:e(()=>[c(" 商品縮圖 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品名稱 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品規格 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品價格 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品數量 ")]),_:1}),t(l,{cols:"2"},{default:e(()=>[c(" 商品小計 ")]),_:1})]),_:1})]),_:1}),(i(!0),g(y,null,b(a.cart,s=>(i(),f(v,{key:s.p_id._id},{default:e(()=>[t(r,{style:{"font-size":"14px"},class:"text-center"},{default:e(()=>[t(l,{cols:"2"},{default:e(()=>[t(D,{src:s.p_id.images[0],height:"50"},null,8,["src"])]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(o(s.p_id.name),1)]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(o(s.colors)+" / "+o(s.sizes),1)]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(" $"+o(s.p_id.price),1)]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(o(s.quantity),1)]),_:2},1024),t(l,{cols:"2",class:"align-self-center"},{default:e(()=>[c(" $"+o(s.p_id.price*s.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),t(l,{class:"d-flex justify-end pe-6"},{default:e(()=>[t(B,{color:"red-darken-3",variant:"outlined",onClick:T(s=>S(a._id),["stop"])},{default:e(()=>[c(" 取消訂單 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):w("",!0),F(E)?w("",!0):(i(),f(M,{key:2},{default:e(()=>[(i(!0),g(y,null,b(p.value,(a,m)=>(i(),f(O,{key:a._id,class:"mb-4"},{default:e(()=>[t(U,{style:q({backgroundColor:m%2===0?"#ECEFF190":"#f0f0f080"})},{default:e(()=>[t(r,null,{default:e(()=>[t(l,{cols:"4",sm:"3"},{default:e(()=>{var s,P,j;return[t(D,{src:(j=(P=(s=a==null?void 0:a.cart[0])==null?void 0:s.p_id)==null?void 0:P.images)==null?void 0:j[0],cover:"",class:"data-img"},null,8,["src"])]}),_:2},1024),t(l,{cols:"8",sm:"9"},{default:e(()=>[t(r,null,{default:e(()=>[t(l,{cols:"12",sm:"7"},{default:e(()=>[ue,n("div",ie,o(a._id),1)]),_:2},1024),t(l,{class:"pt-0 pt-sm-3",sm:"5"},{default:e(()=>[re,n("div",fe,o($(a.createdAt)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["style"]),t(R,null,{default:e(()=>[t(G,null,{default:e(()=>[(i(!0),g(y,null,b(a.cart,s=>(i(),f(v,{key:s.p_id._id},{default:e(()=>[t(r,null,{default:e(()=>[t(l,{cols:"3",class:"ps-sm-4"},{default:e(()=>[t(D,{src:s.p_id.images[0],height:"50",width:"50"},null,8,["src"])]),_:2},1024),t(l,{class:"d-flex"},{default:e(()=>[t(r,{"no-gutters":""},{default:e(()=>[t(l,{cols:"12",class:"align-self-center product-text"},{default:e(()=>[c(o(s.p_id.name),1)]),_:2},1024),t(l,{cols:"12",class:"align-self-center product-text"},{default:e(()=>[c(o(s.colors)+" / "+o(s.sizes),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(l,{class:"d-flex"},{default:e(()=>[t(r,{"no-gutters":""},{default:e(()=>[t(l,{cols:"12",class:"align-self-center product-text"},{default:e(()=>[c(" $"+o(s.p_id.price),1)]),_:2},1024),t(l,{cols:"12",class:"align-self-center product-text"},{default:e(()=>[c(" 數量: "+o(s.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(l,{cols:"3",class:"d-flex per-total"},{default:e(()=>[t(r,{"no-gutters":""},{default:e(()=>[t(l,{cols:"12",class:"align-self-center"},{default:e(()=>[c(" 商品小計: ")]),_:1}),t(l,{cols:"12",class:"align-self-center"},{default:e(()=>[c(" $"+o(s.p_id.price*s.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(l,{cols:"12",class:"pt-0 mb-2"},{default:e(()=>[t(N)]),_:1})]),_:2},1024)]),_:2},1024))),128)),t(v,null,{default:e(()=>[t(r,{class:"justify-end"},{default:e(()=>[t(l,{cols:"12",class:"total-price d-flex align-self-center justify-end pe-sm-16"},{default:e(()=>[c(" 訂單總額: "),n("span",_e,"$"+o(I(a.cart)),1)]),_:2},1024),t(l,{cols:"12",class:"d-flex align-self-center justify-end pe-sm-16"},{default:e(()=>[t(B,{class:"cancel-btn",color:"red-darken-3",variant:"outlined",size:"x-small",onClick:T(s=>S(a._id),["stop"])},{default:e(()=>[c(" 取消訂單 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1}),t(ae,{modelValue:h.value.open,"onUpdate:modelValue":u[0]||(u[0]=a=>h.value.open=a),title:"確認要取消此訂單嗎？",message:"取消後不可恢復。","confirm-text":"確認","cancel-text":"取消","confirm-color":"red-darken-3","cancel-color":"blue-grey-darken-1","cancel-size":"small","confirm-size":"small",onConfirm:K,onCancel:A},null,8,["modelValue"])],64))}};typeof L=="function"&&L(H);const ve=Q(H,[["__scopeId","data-v-d97f5a0f"]]);export{ve as default};
